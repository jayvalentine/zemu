require 'rake/testtask'
require 'rdoc/task'
require 'yard'

# The location of this rakefile.
HERE = __dir__

desc "Run tests"
Rake::TestTask.new do |t|
    t.test_files = FileList['test/config/test_*.rb']
end

namespace :docs do
    desc "Generate documentation"
    task :build do
        system("rm -r #{File.join(HERE, "doc")}")
        
        output = `yardoc`

        unless /100.00% documented/ =~ output
            system("yard stats --list-undoc")
            puts ""
            abort("Aborting task due to missing documentation!")
        end
    end

    desc "View documentation"
    task :view => :build do
        system "firefox #{File.join(HERE, "doc", "index.html")}"
    end
end